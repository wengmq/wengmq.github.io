
## 常见的日志文件及查看方式

日志文件 存放内容

/var/log/message 内核消息及各种应用程序的公共日志信息,包括启动、I/O错误、 网络错误、

/var/log/cron Crond周期性计划任务产生的时间信息

/var/log/dmesg 弓|导过程中的各种时间信息

/var/log/ maillog 进入或发出系统的电子邮件活动

/var/log/lastlog 每个用户最近的登录事件

/var/log/secure 用户认证相关的安全事件信息

/var/log/wtmp 每个用户登录注销及系统启动和停机事件

/var/log/btmp 失败的、错误的登录尝试及验证事件


## 1️⃣ journalctl基本概念

`journalctl` 是 **systemd 的日志查看工具**，它读取 **systemd-journald** 守护进程收集的日志。systemd 日志是二进制存储的（存放在 `/var/log/journal/` 或 `/run/log/journal/`），比传统文本日志 `/var/log/messages` 更灵活和可靠。

特点：

-   可以统一查看系统日志、服务日志、内核日志。
    
-   支持按时间、服务、日志级别、用户、进程等过滤。
    
-   支持实时输出、分页显示和导出日志。
    

---

## 2️⃣ 基本命令

```bash
journalctl
```

-   默认显示 **所有日志**，从最早到最新。
    
-   输出分页显示（通常通过 `less`）。
    

---

## 3️⃣ 常用选项

### 时间相关

-   `--since "YYYY-MM-DD HH:MM:SS"`  
    查看指定时间之后的日志。
    
    ```bash
    journalctl --since "2025-10-10 08:00"
    ```
    
-   `--until "YYYY-MM-DD HH:MM:SS"`  
    查看指定时间之前的日志。
    
-   `-b` 或 `--boot`  
    查看当前启动的日志，`-b -1` 表示上一次启动的日志。
    
    ```bash
    journalctl -b -1
    ```
    

### 服务/单元过滤

-   `-u <unit>`  
    查看指定 systemd 服务的日志。
    
    ```bash
    journalctl -u nginx.service
    journalctl -u sshd.service -b
    ```
    

### 优先级过滤

日志优先级（从高到低）：

```scss
emerg(0) > alert(1) > crit(2) > err(3) > warning(4) > notice(5) > info(6) > debug(7)
```

-   `-p <priority>`  
    过滤指定优先级及以上日志。
    
    ```bash
    journalctl -p err       # 显示错误及更严重日志
    journalctl -p warning   # 显示警告及以上
    ```
    

### 实时监控

-   `-f` 或 `--follow`  
    类似 `tail -f`，实时输出日志。
    
    ```bash
    journalctl -f
    journalctl -u nginx.service -f
    ```
    

### 输出格式

-   `-o <format>` 输出格式：
    
    -   `short`（默认）
        
    -   `json`
        
    -   `json-pretty`
        
    -   `cat`（只显示消息）
        
    
    ```bash
    journalctl -o json-pretty
    ```
    

### 内核日志

-   `-k` 或 `--dmesg`  
    查看内核日志（相当于 `dmesg`）。
    
    ```bash
    journalctl -k
    ```
    

### 用户相关

-   `--user` 查看用户服务日志
    
-   `--uid <UID>` 查看指定用户日志
    
-   `--gid <GID>` 查看指定组日志
    

---

## 4️⃣ 高级用法

### 按进程或PID

```bash
journalctl _PID=1234
journalctl _COMM=nginx
```

### 保存日志到文件

```bash
journalctl -u nginx.service --since today > nginx.log
```

### 限制输出条数

```bash
journalctl -n 50        # 最近 50 条
journalctl -e           # 跳到日志末尾
```

### 结合其他命令

```bash
journalctl -u nginx.service -p err -n 20
journalctl -k | grep -i error
```

---

## 5️⃣ 日志存储位置

-   永久存储：`/var/log/journal/`
    
-   临时存储（重启后消失）：`/run/log/journal/`
    

你可以通过 `journalctl --disk-usage` 查看日志占用磁盘大小。

---

✅ 总结：  
`journalctl` 是 **systemd 日志的万能查看工具**，相比传统文本日志更灵活、更智能。掌握它能快速排查系统问题、服务异常和内核故障。

---