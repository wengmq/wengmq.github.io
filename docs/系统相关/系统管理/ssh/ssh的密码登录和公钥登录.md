## 密码登录

- 工作原理
	- 1.客户端向服务端发起登录请求,服务端返回公钥
	- 2.客户端用公钥加密自己的认证信息,发送到服务端
	- 3.服务端用私钥解密客户端发来的认证信息,匹配则登录成功,否则失败 
![](assets/Pasted%20image%2020240411135946.png)
- 存在的安全隐患
	- 使用密码登录会存在中间人拦截的安全隐患,也就是在客户端发起请求后,可能发送到一个中间人手中(使用一些拦截手段),然后中间人冒充服务端,返回公钥,客户端利用伪造的公钥加密了账号和密码发送给了中间人,中间人在利用自己的私钥进行解密就得到了用户名和密码.
- known_hosts文件
	- 当首次与一个SSH服务器建立连接时，客户端会记录下该服务器返回的的公钥，并保存在known_hosts文件中，以后每次连接该服务器时，客户端都会验证该服务器返回的公钥是否与known_hosts文件中保存的一致。如果不一致，则会发出警告，提示可能存在DNS劫持、中间人攻击等安全问题。因此，known_hosts文件可以保证SSH连接的安全性，防止恶意攻击。

## 公钥登录

- 工作原理
	- 1.客户端将自己的公钥通过安全的手段传输到服务端
	- 2.客户端发起连接请求,服务端利用客户端的公钥加密一段随机文本发送给客户端
	- 3.客户端利用私钥解密,将解密内容发送到服务端,服务端对比解密的内容是否正确,正确建立连接,否则拒绝连接
![](assets/Pasted%20image%2020240411135851.png)

- 配置过程
```
# 客户端生成公钥和私钥 
ssh-keygen -t rsa
# 将生成的公钥以安全的方式传输到要登录的服务器
scp ~/.ssh/id_rsa.pub root@172.17.0.4:~/
# 服务端将客户端的公钥加入到授权列表
cat id_rsa.pub >> ~/.ssh/authorized_keys
```



## 参考：
- https://blog.csdn.net/mizui_i/article/details/121801500
- https://zhuanlan.zhihu.com/p/241341815
